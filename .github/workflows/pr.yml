name: Docker Image CI

on:
    pull_request:
        branches:
            - main

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
        - name: Checkout repository
            uses: actions/checkout@v3

        - name: Login to AWS ECR
            uses: aws-actions/amazon-ecr-login@v1

        - name: Build and push Docker image
            env:
                ECR_REGISTRY: <ECR_REGISTRY>
                ECR_REPOSITORY: <ECR_REPOSITORY>
                IMAGE_TAG: ${{ github.sha }}
            run: |
                docker build -t $ECR_REGISTRY/$ECR_REPOSITORY:$IMAGE_TAG .
                docker push $ECR_REGISTRY/$ECR_REPOSITORY:$IMAGE_TAG